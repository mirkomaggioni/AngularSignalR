var AngularSignalRApp;!function(r){var e=function(){function r(){}return r.module=angular.module("angularSignalR",["ngResource","ui.bootstrap","ui.router","toaster","angular-loading-bar"]),r}();r.AngularSignalR=e,e.module.config(["$stateProvider","$urlRouterProvider",function(r,e){e.otherwise("/orders"),r.state("Orders",{url:"/orders",templateUrl:"/app/views/orders.html",controller:"OrdersController as vm"})}])}(AngularSignalRApp||(AngularSignalRApp={}));var AngularSignalRApp;!function(r){var e;!function(r){var e=function(){function r(){}return r.guidEmpty="00000000-0000-0000-0000-000000000000",r}();r.Constants=e}(e=r.Commons||(r.Commons={}))}(AngularSignalRApp||(AngularSignalRApp={}));var AngularSignalRApp;!function(r){var e;!function(e){var n=function(){function r(){this.restrict="A",this.require="?ngModel"}return r.factory=function(){return function(){return new r}},r.prototype.link=function(r,e,n,t){t.$parsers.push(function(r){if(void 0===r)return"";var e=r.replace(/[^-0-9\.]/g,"");return e.split(".").length>2&&(e=e.substring(0,e.length-1)),e!==r&&(t.$setViewValue(e),t.$render()),e})},r}();e.DecimalNumber=n,r.AngularSignalR.module.directive("decimalNumber",n.factory())}(e=r.Directives||(r.Directives={}))}(AngularSignalRApp||(AngularSignalRApp={}));var AngularSignalRApp;!function(r){var e;!function(e){var n=function(){function r(r){r.go("index.detail")}return r.$inject=["$state"],r}();e.IndexController=n,r.AngularSignalR.module.controller("IndexController",n)}(e=r.Controllers||(r.Controllers={}))}(AngularSignalRApp||(AngularSignalRApp={}));var AngularSignalRApp;!function(r){var e;!function(e){var n=function(){function r(r){this.modalInstance=r}return r.$inject=["$uibModalInstance"],r.prototype.Ok=function(){this.modalInstance.close()},r.prototype.Cancel=function(){this.modalInstance.dismiss("cancel")},r}();e.ModalsController=n,r.AngularSignalR.module.controller("ModalsController",n)}(e=r.Controllers||(r.Controllers={}))}(AngularSignalRApp||(AngularSignalRApp={}));var AngularSignalRApp;!function(r){var e;!function(e){var n=r.Commons.Constants,t=function(){function r(r,e,t,o,i){var a=this;this.filter=r,this.modalService=e,this.ordersService=o,this.notificationsService=i,this.constant=n,this.notificationsService.OnOrderChanges(function(){a.Load()}),this.toaster=t,this.title="Orders",this.Load()}return r.$inject=["$filter","$uibModal","toaster","ordersService","notificationsService"],r.prototype.New=function(){this.order={Id:n.guidEmpty,Article:"",Amount:0,CreationDate:new Date,Customer:"",Notes:""}},r.prototype.Edit=function(r){this.order=r},r.prototype.Delete=function(){var r=this,e=r.modalService.open({animation:!0,templateUrl:"/App/Views/Shared/ConfirmDeleteModal.html",controller:"ModalsController as vm",size:"modal-sm"});e.result.then(function(){r.ordersService["delete"](r.order).$promise.then(function(e){var n=r.filter("filter")(r.orders,{Id:r.order.Id})[0],t=r.orders.indexOf(n);r.orders.splice(t,1),r.order=null,r.notificationsService.NotifyOrderChanges(),r.toaster.success("Order deleted successfully.")},function(e){r.toaster.error("Error deleting order.",e.data.message)})})},r.prototype.Save=function(){var r=this;this.ordersService.save(this.order).$promise.then(function(e){r.order.Id===n.guidEmpty&&(r.order=e,r.orders.push(e)),r.notificationsService.NotifyOrderChanges(),r.toaster.success("Order saved successfully.")},function(e){r.toaster.error("Error saving order",e.data.message)})},r.prototype.Close=function(){this.order=null},r.prototype.Load=function(){var r=this;this.ordersService.getAll().$promise.then(function(e){r.orders=e,r.toaster.success("Orders loaded successfully.")},function(e){r.toaster.error("Error loading orders",e.data.message)})},r}();e.OrdersController=t,r.AngularSignalR.module.controller("OrdersController",t)}(e=r.Controllers||(r.Controllers={}))}(AngularSignalRApp||(AngularSignalRApp={}));var AngularSignalRApp;!function(r){var e;!function(e){var n=function(){function r(){var r=this;this.connection=$.hubConnection(),this.proxy=this.connection.createHubProxy("NotificationsHub"),this.proxy.on("NotifyOrderChanges",function(){r.callback()}),this.connection.start()}return r.factory=function(){return function(){return new r}},r.prototype.NotifyOrderChanges=function(){this.proxy.invoke("OrderChanges")},r.prototype.OnOrderChanges=function(r){r&&(this.callback=r)},r}();e.NotificationsService=n,r.AngularSignalR.module.factory("NotificationsService",[n.factory()])}(e=r.Services||(r.Services={}))}(AngularSignalRApp||(AngularSignalRApp={}));var AngularSignalRApp;!function(r){var e;!function(e){var n=r.Commons.Constants,t=function(){function r(r){this.resource=r("/api/orders/:id",{id:"@Id"},{get:{method:"GET"},create:{method:"POST"},save:{method:"PUT"},query:{method:"GET",isArray:!0},"delete":{method:"DELETE"}})}return r.factory=function(){return function(e){return new r(e)}},r.prototype.create=function(r){return this.resource.create(r)},r.prototype.save=function(r){return r.Id===n.guidEmpty?this.resource.create(r):this.resource.save(r)},r.prototype["delete"]=function(r){return this.resource.remove(r)},r.prototype.getAll=function(){return this.resource.query()},r}();e.OrdersService=t,r.AngularSignalR.module.factory("OrdersService",["$resource",t.factory()])}(e=r.Services||(r.Services={}))}(AngularSignalRApp||(AngularSignalRApp={}));